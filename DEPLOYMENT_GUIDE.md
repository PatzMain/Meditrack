# 🚀 MediTrack Deployment Guide

## Free Hosting Solution: Railway.app + Vercel

This guide will help you deploy MediTrack using **Railway.app** for the backend & database, and **Vercel** for the frontend.

### 🎯 **Why Railway.app?**
- ✅ Free tier with $5/month credit (enough for development)
- ✅ Built-in PostgreSQL database
- ✅ Automatic deployments from GitHub
- ✅ Zero configuration needed
- ✅ Environment variables management

---

## 📋 **Prerequisites**

1. **GitHub Account** (free)
2. **Railway.app Account** (free - sign up at https://railway.app)
3. **Vercel Account** (free - sign up at https://vercel.com)

---

## 🗄️ **Step 1: Set Up Repository**

1. **Create a new GitHub repository:**
   ```bash
   # Initialize git (if not already done)
   git init
   git add .
   git commit -m "Initial commit: MediTrack Clinic Management System"
   
   # Add your GitHub repository
   git remote add origin https://github.com/yourusername/meditrack.git
   git push -u origin main
   ```

---

## 🖥️ **Step 2: Deploy Backend on Railway.app**

### 2.1 Create Railway Project
1. Go to [Railway.app](https://railway.app)
2. Click **"Start a New Project"**
3. Choose **"Deploy from GitHub repo"**
4. Select your MediTrack repository
5. Railway will auto-detect it's a Node.js project

### 2.2 Add PostgreSQL Database
1. In your Railway project dashboard
2. Click **"New"** → **"Database"** → **"Add PostgreSQL"**
3. Railway will create a PostgreSQL instance automatically
4. Copy the **DATABASE_URL** from the database settings

### 2.3 Configure Environment Variables
In Railway project settings → Variables, add:

```bash
NODE_ENV=production
DATABASE_URL=<auto-generated-by-railway>
JWT_SECRET=super-secure-random-string-at-least-32-chars
ALLOWED_ORIGINS=https://your-frontend-domain.vercel.app
```

### 2.4 Set Build Configuration
Create `railway.toml` in backend root (already created):
```toml
[build]
builder = "nixpacks"

[deploy]
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "never"

[environment]
NODE_ENV = "production"
PORT = "$PORT"
DATABASE_URL = "$DATABASE_URL"
```

### 2.5 Initialize Database
After deployment, run the database initialization:
1. Go to Railway project → **"Deployments"**
2. Click on latest deployment
3. Open **"Logs"** tab
4. The app should automatically initialize the database on first run

**Your backend URL will be:** `https://your-project-name.up.railway.app`

---

## 🌐 **Step 3: Deploy Frontend on Vercel**

### 3.1 Prepare Frontend
Update the API base URL in your frontend:

**Edit `apps/frontend/src/lib/api.ts`:**
```typescript
const API_BASE_URL = process.env.NODE_ENV === 'production' 
  ? 'https://your-project-name.up.railway.app/api'
  : 'http://localhost:3001/api';
```

### 3.2 Deploy to Vercel
1. Go to [Vercel.com](https://vercel.com)
2. Click **"New Project"**
3. Import your GitHub repository
4. Set **Root Directory** to: `apps/frontend`
5. Framework Preset: **Vite**
6. Click **"Deploy"**

### 3.3 Configure Environment Variables
In Vercel project settings → Environment Variables:
```bash
VITE_API_URL=https://your-project-name.up.railway.app/api
NODE_ENV=production
```

**Your frontend URL will be:** `https://your-project-name.vercel.app`

---

## 🔧 **Step 4: Update CORS Settings**

Update your Railway backend environment variables:
```bash
ALLOWED_ORIGINS=https://your-project-name.vercel.app
```

---

## 🧪 **Step 5: Test the Deployment**

### Login Credentials:
- **Superadmin:** `director@meditrack.com` / `password`
- **Admin:** `pharmacy@meditrack.com` / `password`  
- **Demo:** `admin@clinic.com` / `password`

### Test Features:
1. ✅ User authentication
2. ✅ Medicine management
3. ✅ Patient records
4. ✅ Medical records
5. ✅ Universal search
6. ✅ Profile management

---

## 📊 **Database Schema**

The system includes:
- **Users** (authentication & roles)
- **Patients** (patient information)
- **Medicines** (medical & dental supplies)
- **Consultations** (medical records)
- **Supplies** (medical supplies)
- **Equipment** (medical equipment)
- **Activity Logs** (system audit trail)

---

## 💰 **Cost Breakdown (FREE)**

| Service | Free Tier Limits | Cost |
|---------|------------------|------|
| **Railway.app** | $5/month credit, PostgreSQL included | **FREE** |
| **Vercel** | 100GB bandwidth, unlimited deployments | **FREE** |
| **GitHub** | Unlimited public repos | **FREE** |
| **Total** | | **$0/month** |

---

## 🔒 **Security Features**

- ✅ **JWT Authentication**
- ✅ **Password Hashing** (bcrypt)
- ✅ **CORS Protection**
- ✅ **Rate Limiting**
- ✅ **Helmet Security Headers**
- ✅ **Input Validation**
- ✅ **SQL Injection Protection**
- ✅ **Environment Variables**

---

## 🚨 **Important Security Notes**

1. **Change default passwords** after deployment
2. **Use strong JWT secrets** (32+ characters)
3. **Set proper CORS origins**
4. **Enable 2FA** on Railway and Vercel accounts
5. **Regularly update dependencies**

---

## 📈 **Scaling Options**

### When you need more resources:
- **Railway:** Upgrade to Pro plan ($20/month)
- **Vercel:** Pro plan ($20/month) for advanced features
- **Database:** Railway Pro includes more database resources

---

## 🆘 **Troubleshooting**

### Common Issues:

1. **Database Connection Failed**
   - Check DATABASE_URL format
   - Ensure PostgreSQL service is running
   - Verify firewall settings

2. **CORS Errors**
   - Update ALLOWED_ORIGINS environment variable
   - Check frontend API URL configuration

3. **Build Failures**
   - Check Node.js version compatibility
   - Verify all dependencies in package.json
   - Review build logs for specific errors

### Debug Commands:
```bash
# Check database connection
npm run init-db

# View application logs
# (Available in Railway dashboard)

# Test API endpoints
curl https://your-backend-url.up.railway.app/health
```

---

## 🎉 **Congratulations!**

Your MediTrack Clinic Management System is now live and ready for use!

- **Frontend:** https://your-project-name.vercel.app
- **Backend API:** https://your-project-name.up.railway.app
- **Database:** PostgreSQL on Railway (managed)

---

## 📞 **Support**

If you encounter any issues:
1. Check the Railway/Vercel deployment logs
2. Review this deployment guide
3. Ensure all environment variables are set correctly
4. Test locally first before deploying changes